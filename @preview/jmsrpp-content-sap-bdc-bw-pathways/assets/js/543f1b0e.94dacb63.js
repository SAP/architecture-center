"use strict";(self.webpackChunksap_architecture_center=self.webpackChunksap_architecture_center||[]).push([[82287],{6714:(e,n,a)=>{a.d(n,{A:()=>t});const t=a.p+"assets/images/mt-user-roles-58561f93d36c861325526b9e44c277dd.svg"},26980:(e,n,a)=>{a.d(n,{A:()=>t});const t=a.p+"assets/images/mt-data-separation-4109067d28c6de9ddbfd24ae8356448b.svg"},28453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>r});var t=a(96540);const i={},s=t.createContext(i);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(s.Provider,{value:n},e.children)}},59575:(e,n,a)=>{a.d(n,{A:()=>t});const t=a.p+"assets/images/mt-consumer-pov-b5809db2bed6da40dfce66a98be275a2.svg"},71332:(e,n,a)=>{a.d(n,{A:()=>t});const t=a.p+"assets/images/mt-provider-pov-69b44a3eb848b4187d205a41a2772acd.svg"},78555:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"ref-arch/RA0007/mt-models/id-ra0007-2","title":"Tenant Model on SAP BTP","description":"Tenant Model on SAP BTP","source":"@site/docs/ref-arch/RA0007/3-mt-models/readme.md","sourceDirName":"ref-arch/RA0007/3-mt-models","slug":"/ref-arch/d31bedf420/2","permalink":"/@preview/jmsrpp-content-sap-bdc-bw-pathways/docs/ref-arch/d31bedf420/2","draft":false,"unlisted":false,"editUrl":"https://github.com/SAP/architecture-center/edit/dev/docs/ref-arch/RA0007/3-mt-models/readme.md","tags":[{"inline":false,"label":"Application Development & Automation","permalink":"/@preview/jmsrpp-content-sap-bdc-bw-pathways/docs/tags/appdev","description":"Extend, create, and automate apps for SAP and non-SAP solutions."},{"inline":false,"label":"CAP","permalink":"/@preview/jmsrpp-content-sap-bdc-bw-pathways/docs/tags/cap","description":"SAP Cloud Application Programming Model (CAP) is a framework of languages, libraries, and tools for building enterprise-grade services and applications. It guides developers along a path of proven best practices and a great wealth of out-of-the-box solutions to recurring tasks."},{"inline":false,"label":"Generative AI","permalink":"/@preview/jmsrpp-content-sap-bdc-bw-pathways/docs/tags/genai","description":"Generative AI is a type of AI that is capable of generating new data, such as images, videos, and text, based on the data it has been trained on."}],"version":"current","lastUpdatedBy":"Ajit Kumar Panda","lastUpdatedAt":1738281600000,"sidebarPosition":1,"frontMatter":{"id":"id-ra0007-2","slug":"/ref-arch/d31bedf420/2","sidebar_position":1,"sidebar_custom_props":{"category_index":[]},"title":"Tenant Model on SAP BTP","description":"Tenant Model on SAP BTP","keywords":["sap","btp","multitenant","saas","cap"],"sidebar_label":"Tenant Model on SAP BTP","image":"img/ac-soc-med.png","tags":["appdev","cap","genai"],"hide_table_of_contents":false,"hide_title":false,"toc_min_heading_level":2,"toc_max_heading_level":4,"draft":false,"unlisted":false,"contributors":["AjitKP91","alperdedeoglu"],"discussion":null,"last_update":{"author":"Ajit Kumar Panda","date":"2025-01-31T00:00:00.000Z"}},"sidebar":"refarchSidebar","previous":{"title":"Benefits of Multitenant Applications","permalink":"/@preview/jmsrpp-content-sap-bdc-bw-pathways/docs/ref-arch/d31bedf420/1"},"next":{"title":"Tenant Lifecycle Management","permalink":"/@preview/jmsrpp-content-sap-bdc-bw-pathways/docs/ref-arch/d31bedf420/3"}}');var i=a(74848),s=a(28453);const o={id:"id-ra0007-2",slug:"/ref-arch/d31bedf420/2",sidebar_position:1,sidebar_custom_props:{category_index:[]},title:"Tenant Model on SAP BTP",description:"Tenant Model on SAP BTP",keywords:["sap","btp","multitenant","saas","cap"],sidebar_label:"Tenant Model on SAP BTP",image:"img/ac-soc-med.png",tags:["appdev","cap","genai"],hide_table_of_contents:!1,hide_title:!1,toc_min_heading_level:2,toc_max_heading_level:4,draft:!1,unlisted:!1,contributors:["AjitKP91","alperdedeoglu"],discussion:null,last_update:{author:"Ajit Kumar Panda",date:new Date("2025-01-31T00:00:00.000Z")}},r=void 0,c={},l=[{value:"Application Provider",id:"application-provider",level:4},{value:"Application Consumer",id:"application-consumer",level:4},{value:"Multitenancy Model on SAP BTP",id:"multitenancy-model-on-sap-btp",level:2},{value:"Provider Subaccount",id:"provider-subaccount",level:4},{value:"Consumer/Tenant Subaccount",id:"consumertenant-subaccount",level:4},{value:"Application Provider Point of View",id:"application-provider-point-of-view",level:3},{value:"Application Consumer Point of View",id:"application-consumer-point-of-view",level:3},{value:"Data Separation in Multitenant Applications",id:"data-separation-in-multitenant-applications",level:2},{value:"Column Discriminator",id:"column-discriminator",level:3},{value:"Database Separation",id:"database-separation",level:3},{value:"Schema Separation",id:"schema-separation",level:3},{value:"References",id:"references",level:2}];function d(e){const n={a:"a",admonition:"admonition",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"There are multiple ways to design a multitenant application. Your choice of approach depends importantly on whether and how you share resources among your tenants. Intuitively, the more resources you share, the more cost-efficient your application will be. However, sharing resources might also increase the complexity of your application. In SAP BTP, you can develop and run multitenant applications that can be accessed by multiple consumers (tenants) through a dedicated URL."}),"\n",(0,i.jsx)(n.p,{children:"When designing a multitenant application, it is important to understand different personas involved. The multitenancy concept involves two main personas:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h4,{id:"application-provider",children:"Application Provider"}),"\n","The entity that develops, deploys, and manages the multitenant application. This could be an independent software vendor (ISV), a software development company, or an internal IT department. The application provider is responsible for creating the software, configuring the multitenant architecture, and managing the application lifecycle."]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h4,{id:"application-consumer",children:"Application Consumer"}),"\n","The end-user or tenant who interacts with the multitenant application. This could be an individual user, a company, or an organization that subscribes to the service. The application consumer uses the software to perform specific tasks or access functionality provided by the application provider."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"multitenancy-model-on-sap-btp",children:"Multitenancy Model on SAP BTP"}),"\n",(0,i.jsxs)(n.p,{children:["Before jumping into the details of multitenancy model on SAP BTP, it is important to understand the concept of Account Model or Structure of SAP BTP. It is highly recommended to go through the ",(0,i.jsx)(n.a,{href:"https://help.sap.com/docs/btp/sap-business-technology-platform/account-model",children:"Account Model of SAP BTP"})," to understand the concept of global account, subaccount etc."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image",src:a(6714).A+"",width:"681",height:"521"})}),"\n",(0,i.jsxs)(n.p,{children:["In SAP BTP, multitenancy is implemented using the concept of ",(0,i.jsx)(n.a,{href:"https://help.sap.com/docs/btp/sap-business-technology-platform/account-model#subaccounts",children:"subaccounts"}),". In multitenancy context, two kinds of subaccounts are used:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h4,{id:"provider-subaccount",children:"Provider Subaccount"}),"\n",(0,i.jsx)(n.p,{children:"The application provider is the vendor of the SaaS application. The application provider is going to build, deliver, and operate the multitenant SaaS solution for all consumers. It owns a global account in SAP BTP and builds and deploys the application in a Subaccount which is referred as the provider subaccount."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h4,{id:"consumertenant-subaccount",children:"Consumer/Tenant Subaccount"}),"\n",(0,i.jsx)(n.p,{children:"A consumer or tenant is the user of the SaaS application. This can be another team or company that will use the multitenant SaaS solution. For each consumer, a dedicated subaccount is created within the vendor's global account in SAP BTP. Each consumer subscribes to the SaaS solution from their subaccount, referred to as the consumer subaccount. Upon subscription to the SaaS application, each consumer receives a dedicated URL to access the SaaS application."}),"\n",(0,i.jsxs)(n.admonition,{title:"Consumer vs Tenant",type:"tip",children:[(0,i.jsx)(n.p,{children:"It's important to differentiate between consumer and tenant. While a consumer can consume multiple SaaS applications, a tenant is a specific instance of a SaaS application of a dedicated consumer. Still, a tenant subaccount and a consumer subaccount refer to the same entity, meaning a dedicated subaccount in which multiple tenant instances of SaaS applications are subscribed."}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"subaccount - consumer [1..1]: For each subaccount, there can only be one consumer assignment"}),"\n",(0,i.jsx)(n.li,{children:"subaccount - tenant [1..1]: For each subaccount, there can only be one tenant per SaaS application"}),"\n",(0,i.jsx)(n.li,{children:"consumer - tenant [1..1]: For each consumer, there can only be one tenant per SaaS application"}),"\n"]})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"application-provider-point-of-view",children:"Application Provider Point of View"}),"\n",(0,i.jsx)(n.p,{children:"The following figure illustrates the relationship between the provider subaccount and consumer subaccounts (tenants) in the application provider's global account in SAP BTP."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image",src:a(71332).A+"",width:"911",height:"541"})}),"\n",(0,i.jsxs)(n.p,{children:["The application provider deploys the multitenant application to the provider subaccount. The application is then registered with the ",(0,i.jsx)(n.a,{href:"https://discovery-center.cloud.sap/serviceCatalog/saas-provisioning-service?service_plan=application&region=all&commercialModel=btpea",children:"SAP Software-as-a-Service Provisioning service"}),", which makes the application available in service marketplace for subscription from consumer subaccount. Subsequently the consumer subaccounts subscribe to the SaaS application."]}),"\n",(0,i.jsxs)(n.admonition,{title:"SAP Software-as-a-Service Provisioning service:",type:"info",children:[(0,i.jsx)(n.p,{children:"This service helps manage and automate the subscription lifecycle of multitenant applications on SAP BTP. It provides apis for registering, subscribing, and managing SaaS applications and tenants. Key feature of the service includes:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Subscription Management: enables subscribing and unsubscribing tenants to multitenant applications and services."}),"\n",(0,i.jsx)(n.li,{children:"Registration Details: retrieves details of registered multitenant applications."}),"\n",(0,i.jsx)(n.li,{children:"Subscription Information: provides information on current subscriptions, including tenant ids and dependencies."}),"\n",(0,i.jsx)(n.li,{children:"Dependency Management: allows updating services that a multitenant application depends on."}),"\n",(0,i.jsx)(n.li,{children:"Job Information: tracks the status of subscription-related operations, like subscribing, unsubscribing, or updating dependencies.\nIn short, this service manages the lifecycle of multitenant applications, including tenant subscription, registration, dependency updates, and related job status tracking."}),"\n"]})]}),"\n",(0,i.jsx)(n.h3,{id:"application-consumer-point-of-view",children:"Application Consumer Point of View"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"image",src:a(59575).A+"",width:"911",height:"541"})}),"\n",(0,i.jsx)(n.p,{children:"Each consumer has a dedicated subaccount in the application provider's global account. The consumer subscribes to the application using either the SAP BTP cockpit, SAP BTP command-line interface, or a dedicated REST api. The consumer receives a dedicated URL so that its business users can access the application. When a consumer accesses the application, the application environment identifies them by their unique tenant id. The application distinguishes between requests from different consumer tenants based on the tenant id, thus ensuring data isolation."}),"\n",(0,i.jsx)(n.p,{children:"As with any application running in SAP BTP, these multitenant applications consume platform resources. The costs for these consumed resources, and those of the application consumer, are billed to the provider of the multitenant application."}),"\n",(0,i.jsx)(n.h2,{id:"data-separation-in-multitenant-applications",children:"Data Separation in Multitenant Applications"}),"\n",(0,i.jsx)(n.p,{children:"Data separation is a key aspect of multitenant applications. Each tenant's data and configurations are kept separate from other tenants. This is crucial for maintaining data privacy, security, and compliance. There are three main approaches to achieving data separation in a multitenant architecture."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"mt-data-separation",src:a(26980).A+"",width:"881",height:"321"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"column-discriminator",children:"Column Discriminator"}),"\n",(0,i.jsx)(n.p,{children:"In this approach, a column discriminator is used to differentiate between data belonging to different tenants. Only one table is used for the entire application and for all consumers. Each table in the database has an additional column that stores the tenant id. At the application level, every CRUD operation (Create, Read, Update, Delete) needs to filter based on the tenant id. For example, when performing an INSERT or SELECT, a WHERE clause on the tenant id must be used to ensure that each tenant only interacts with its own data."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pros"}),": cost-effective since it utilizes a single schema within a single database instance, easy to set up."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cons"}),": requires additional filtering logic in all queries, can lead to performance overhead, higher risk of exposing unwanted data, may not compliant with data protection laws."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"database-separation",children:"Database Separation"}),"\n",(0,i.jsx)(n.p,{children:"In this approach, each tenant has their own dedicated database instance. The application uses a separate database connection for each tenant, ensuring that data is isolated at the database level. This approach is more secure and compliant with data protection laws, as each tenant's data is physically separated from other tenants."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pros"}),": secure and compliant with data protection laws, better performance, less risk of exposing unwanted data."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cons"}),": higher cost due to multiple database instances, more complex to set up and maintain."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.h3,{id:"schema-separation",children:"Schema Separation"}),"\n",(0,i.jsx)(n.p,{children:"In this approach, each tenant has their own dedicated schema within a shared database instance. The application uses a separate schema for each tenant, ensuring that data is isolated at the schema level. This approach provides a balance between cost and security, as each tenant's data is logically separated but physically stored in the same database instance."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pros"}),": cost-effective, secure, and compliant with data protection laws, less risk of exposing unwanted data."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cons"}),": more complex to set up and maintain compared to column discriminator, may require additional logic to manage schema creation and deletion."]}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{title:"SAP Recommendation",type:"tip",children:[(0,i.jsx)(n.p,{children:"SAP recommends schema separation approach for its flexibility and cost-effectiveness."}),(0,i.jsxs)(n.p,{children:["In case of ",(0,i.jsx)(n.a,{href:"https://discovery-center.cloud.sap/serviceCatalog/sap-hana-cloud?region=all",children:"SAP HANA Cloud"}),", the ",(0,i.jsx)(n.a,{href:"https://help.sap.com/docs/hana-cloud-database/sap-hana-cloud-sap-hana-database-developer-guide-for-cloud-foundry-multitarget-applications-sap-web-ide-full-stack/sap-hana-cloud-deployment-infrastructure-services",children:"HDI container feature"})," is used to implement schema separation."]}),(0,i.jsx)(n.p,{children:"HDI containers provide isolation. Identical objects can be deployed multiple times into various HDI containers in the same SAP HANA Cloud database. This allows for the installation of multiple instances of the same software product within the same database. HDI containers are segregated from each other using schema level access permissions. By default, access between containers at the database level is prohibited. However, this can be overridden by granting the relevant privileges, for instance, by using synonyms. With this, an application is provided with the necessary credentials to access an HDI container, which is essentially a database schema that comes with supplementary metadata."}),(0,i.jsxs)(n.p,{children:["For each consumer tenant, a dedicated HDI container is created, which contains the schema and tables specific to that tenant. On subscription, creation of HDI container for each consumer can be automated with ",(0,i.jsx)(n.a,{href:"https://discovery-center.cloud.sap/serviceCatalog/service-manager?region=all",children:"SAP Service Manager"})," which helps to create or manage service instances on SAP BTP."]})]}),"\n",(0,i.jsxs)(n.admonition,{title:"SAP Service Manager",type:"info",children:[(0,i.jsx)(n.p,{children:"SAP Service Manager service is the central registry for service brokers and platforms in SAP BTP. It allows you to consume platform services in any connected runtime environment, track the creation and management of service instances, and share services and service instances between different environments."}),(0,i.jsx)(n.p,{children:"SAP Service Manager supports services that implement the Open Service Broker API Information (OSBAPI), and can be consumed natively in OSBAPI-enabled environments such as cloud foundry and kubernetes. SAP Service Manager can be accessed via the SAP BTP cockpit, command line tool or api, and allows management of platforms, service brokers, service instances, and service bindings. It's tightly integrated with SAP BTP services, and enforces service access rules and quotas."})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://community.sap.com/t5/technology-blogs-by-sap/fundamentals-of-multitenancy-in-sap-btp/ba-p/13527283",children:"SAP Blog - Fundamentals of Multitenancy in SAP BTP"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://help.sap.com/docs/btp/sap-business-technology-platform/developing-multitenant-applications-in-cloud-foundry-environment",children:"Developing Multitenant Applications in the Cloud Foundry Environment"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/azure-sql/database/saas-tenancy-app-design-patterns?view=azuresql",children:"Multitenant SaaS database tenancy patterns"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://help.sap.com/docs/hana-cloud-database/sap-hana-cloud-sap-hana-database-developer-guide-for-cloud-foundry-multitarget-applications-sap-web-ide-full-stack/sap-hana-cloud-deployment-infrastructure-services",children:"SAP HANA Cloud Deployment-Infrastructure Services"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);