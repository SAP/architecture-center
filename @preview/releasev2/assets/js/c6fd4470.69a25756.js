"use strict";(self.webpackChunksap_architecture_center=self.webpackChunksap_architecture_center||[]).push([[8499],{30872:(e,a,i)=>{i.d(a,{A:()=>r});const r={headerBar:"headerBar_Ds_q",mainContainer:"mainContainer_IaM3",uploadPrompt:"uploadPrompt_l2IM",uploadIcon:"uploadIcon__ogT",contentArea:"contentArea_eVEL",actionsHeader:"actionsHeader_HIZQ",actionButtons:"actionButtons_dOTS",addFilesButton:"addFilesButton_o2BY",validateButton:"validateButton_iYnD",clearButton:"clearButton_Onu6",progressBarContainer:"progressBarContainer_q99b",progressBar:"progressBar_SuZC",fileListContainer:"fileListContainer_MVa2",fileCard:"fileCard_XwRh",validating:"validating_a2Gr",success:"success_ZszJ",warning:"warning_XVML",error:"error_U6SV",fileCardHeader:"fileCardHeader_DOTx",fileInfo:"fileInfo_lAXQ",statusName:"statusName_vNOt",fileName:"fileName_7msN",cardActions:"cardActions_eP08",cardValidateButton:"cardValidateButton_mcJl",cardRemoveButton:"cardRemoveButton_mIxr",previewAndResults:"previewAndResults_GRJH",previewWrapper:"previewWrapper_MBIr",diagramViewer:"diagramViewer_WBDA",resultsContainer:"resultsContainer_vS18",resultsPlaceholder:"resultsPlaceholder_bfCr",validatingContainer:"validatingContainer_dWs_",loadingSpinner:"loadingSpinner_aphw",spin:"spin_wFGE",validatingText:"validatingText_OB1i",violationCard:"violationCard_Rdxi",errorCard:"errorCard_KB7P",warningCard:"warningCard_zpfW",successCard:"successCard_WqSB",infoCard:"infoCard_hOmu",violationHeader:"violationHeader_tgDj",severityBadge:"severityBadge__PTV",violationRule:"violationRule_O5SZ",violationDetails:"violationDetails_Wa9v",authRequired:"authRequired_nPa5",loginButton:"loginButton_IHjd",authHelpText:"authHelpText_pJgJ"}},61610:(e,a,i)=>{i.a(e,async(e,r)=>{try{i.r(a),i.d(a,{default:()=>v});var s=i(96540),t=i(8768),n=i(94335),l=i(30872),o=i(44586),d=i(96392),c=i(82295),u=i(74848),h=e([t]),m=h.then?(await h)():h;function v(){const{siteConfig:e}=(0,o.A)(),{user:a,users:i,loading:r}=(0,c.A)(),[h,m]=(0,s.useState)([]),[p,v]=(0,s.useState)(!1),[g,A]=(0,s.useState)(0),[x,f]=(0,s.useState)(!1),j=(0,s.useRef)(null),C=null!==i.btp;if((0,s.useEffect)(()=>{if(!r&&!C&&!x){f(!0);const a=e.customFields.backendUrl;window.location.href=`${a}/user/login?origin_uri=${encodeURIComponent(window.location.href)}&provider=btp`}},[r,C,x,e.customFields.backendUrl]),r)return(0,u.jsxs)(t.A,{children:[(0,u.jsxs)("div",{className:l.A.headerBar,children:[(0,u.jsx)("h1",{children:"Architecture Validator"}),(0,u.jsx)("p",{children:"Loading..."})]}),(0,u.jsx)("main",{className:l.A.mainContainer,children:(0,u.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:(0,u.jsx)("p",{children:"Checking authentication..."})})})]});if(!C)return(0,u.jsxs)(t.A,{children:[(0,u.jsxs)("div",{className:l.A.headerBar,children:[(0,u.jsx)("h1",{children:"Architecture Validator"}),(0,u.jsx)("p",{children:"BTP authentication required to access this feature"})]}),(0,u.jsx)("main",{className:l.A.mainContainer,children:(0,u.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:(0,u.jsxs)("div",{className:l.A.authRequired,children:[(0,u.jsx)("h2",{children:"\ud83d\udd12 BTP Authentication Required"}),(0,u.jsx)("p",{children:"The Architecture Validator requires BTP authentication to ensure secure access to validation services."}),a&&"btp"!==a.provider?(0,u.jsxs)("p",{children:["You are currently logged in with ",a.provider.toUpperCase(),", but this feature requires BTP login."]}):(0,u.jsx)("p",{children:"You will be redirected to the BTP login page automatically, or you can click the button below to login manually."}),(0,u.jsx)("button",{className:l.A.loginButton,onClick:()=>{const a=e.customFields.backendUrl;window.location.href=`${a}/user/login?origin_uri=${encodeURIComponent(window.location.href)}&provider=btp`},children:"Login with BTP to Continue"}),(0,u.jsx)("p",{className:l.A.authHelpText,children:"After logging in with BTP, you'll be redirected back to this page."})]})})})]});const _=(e,a)=>{m(i=>i.map(i=>i.id===e?{...i,...a}:i))},N=e=>{const a=Array.from(e).filter(e=>e.name.toLowerCase().endsWith(".drawio")).map(e=>new Promise(a=>{const i=new FileReader;i.onload=i=>{a({id:`${e.name}-${e.lastModified}-${Math.random()}`,file:e,content:i.target?.result,status:"batched",results:null,error:null})},i.readAsText(e)}));Promise.all(a).then(e=>{m(a=>[...a,...e])})},w=e=>{e.target.files&&N(e.target.files),e.target.value=""},B=async a=>{_(a.id,{status:"validating"});try{const i=new FormData;i.append("file",a.file),console.log("Using API URL:",e.customFields.validatorApiUrl);const r=e.customFields.validatorApiUrl,s=d.q.load(),t=s?.token;if(!t)throw new Error("Authentication token not found. Please log in.");const l=await n.A.post(r,i,{headers:{Authorization:`Bearer ${t}`}}),o=l.data.validationReport.filter(e=>"INFO"!==e.severity);let c="success";o.some(e=>"ERROR"===e.severity)?c="error":o.some(e=>"WARNING"===e.severity)&&(c="warning"),_(a.id,{status:c,results:o})}catch(i){const e=i instanceof Error?i.message:"An unexpected error occurred.";_(a.id,{status:"error",error:e})}};return(0,u.jsxs)(t.A,{children:[(0,u.jsxs)("div",{className:l.A.headerBar,children:[(0,u.jsx)("h1",{children:"Architecture Validator"}),(0,u.jsx)("p",{children:"Upload, preview, and validate your .drawio diagrams against best practices."})]}),(0,u.jsx)("main",{className:l.A.mainContainer,children:0===h.length?(0,u.jsxs)("div",{className:l.A.uploadPrompt,onDragOver:e=>e.preventDefault(),onDrop:e=>{e.preventDefault(),e.dataTransfer.files&&N(e.dataTransfer.files)},onClick:()=>j.current?.click(),children:[(0,u.jsx)("input",{ref:j,type:"file",accept:".drawio",onChange:w,style:{display:"none"},multiple:!0}),(0,u.jsx)("div",{className:l.A.uploadIcon,children:"\u2b06\ufe0f"}),(0,u.jsx)("h2",{children:"Drag & Drop your .drawio files here"}),(0,u.jsx)("p",{children:"or click to select files"})]}):(0,u.jsxs)("div",{className:l.A.contentArea,children:[(0,u.jsxs)("div",{className:l.A.actionsHeader,children:[(0,u.jsx)("button",{className:l.A.addFilesButton,onClick:()=>j.current?.click(),children:"+ Add More Files"}),(0,u.jsx)("input",{ref:j,type:"file",accept:".drawio",onChange:w,style:{display:"none"},multiple:!0}),(0,u.jsxs)("div",{className:l.A.actionButtons,children:[(0,u.jsx)("button",{className:l.A.clearButton,onClick:()=>{m([]),A(0),v(!1)},children:"Clear All"}),(0,u.jsx)("button",{className:l.A.validateButton,onClick:async()=>{v(!0),A(0);const e=h.filter(e=>"batched"===e.status);let a=0;const i=e.length,r=e.map(async e=>{try{await B(e)}finally{a++,A(a/i*100)}});await Promise.all(r),v(!1)},disabled:p||!h.some(e=>"batched"===e.status),children:p?"Validating...":`Validate Batch (${h.filter(e=>"batched"===e.status).length})`})]})]}),p&&(0,u.jsx)("div",{className:l.A.progressBarContainer,children:(0,u.jsx)("div",{className:l.A.progressBar,style:{width:`${g}%`}})}),(0,u.jsx)("div",{className:l.A.fileListContainer,children:h.map(e=>(0,u.jsxs)("div",{className:`${l.A.fileCard} ${l.A[e.status]}`,children:[(0,u.jsxs)("div",{className:l.A.fileCardHeader,children:[(0,u.jsxs)("div",{className:l.A.fileInfo,children:[(0,u.jsx)("span",{className:l.A.statusName,children:e.status.toUpperCase()}),(0,u.jsx)("h3",{className:l.A.fileName,children:e.file.name})]}),(0,u.jsxs)("div",{className:l.A.cardActions,children:["batched"===e.status&&(0,u.jsx)("button",{className:l.A.cardValidateButton,onClick:()=>B(e),children:"Validate"}),(0,u.jsx)("button",{className:l.A.cardRemoveButton,onClick:()=>{return a=e.id,void m(e=>e.filter(e=>e.id!==a));var a},title:"Remove File",children:"\u2715"})]})]}),(0,u.jsxs)("div",{className:l.A.previewAndResults,children:[(0,u.jsx)("div",{className:l.A.previewWrapper,children:(0,u.jsx)("iframe",{src:`https://viewer.diagrams.net/?lightbox=1&edit=_blank&layers=1&nav=1#R${encodeURIComponent(e.content)}`,className:l.A.diagramViewer,title:e.file.name})}),(0,u.jsxs)("div",{className:l.A.resultsContainer,children:["validating"===e.status?(0,u.jsxs)("div",{className:l.A.validatingContainer,children:[(0,u.jsx)("div",{className:l.A.loadingSpinner}),(0,u.jsx)("div",{className:l.A.validatingText,children:"Validating..."})]}):e.results||e.error?null:(0,u.jsx)("div",{className:l.A.resultsPlaceholder,children:"Validation results will appear here."}),e.error&&(0,u.jsxs)("div",{className:`${l.A.violationCard} ${l.A.errorCard}`,children:[(0,u.jsx)("strong",{children:"API Error:"})," ",e.error]}),0===e.results?.length&&(0,u.jsxs)("div",{className:`${l.A.violationCard} ${l.A.successCard}`,children:[(0,u.jsx)("strong",{children:"Validation Passed:"})," No issues found."]}),e.results?.map((e,a)=>(0,u.jsxs)("div",{className:`${l.A.violationCard} ${l.A[e.severity.toLowerCase()+"Card"]}`,children:[(0,u.jsx)("div",{className:l.A.violationHeader,children:(0,u.jsx)("span",{className:l.A.severityBadge,children:e.severity})}),(0,u.jsxs)("div",{className:l.A.violationRule,children:[(0,u.jsx)("strong",{children:"Rule:"})," ",e.rule]}),(0,u.jsxs)("div",{className:l.A.violationDetails,children:[(0,u.jsx)("strong",{children:"Details:"})," ",e.details]})]},a))]})]})]},e.id))})]})})]})}t=m[0],r()}catch(p){r(p)}})}}]);